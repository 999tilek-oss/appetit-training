<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: #F7F7F7; min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); overflow: hidden; border: 1px solid #e0e0e0; }
        .header { background: linear-gradient(135deg, #E94A4E 0%, #d63c40 100%); color: white; padding: 35px 30px; text-align: center; position: relative; overflow: hidden; }
        .header::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 20px 20px; opacity: 0.1; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; font-weight: 700; position: relative; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .header p { font-size: 1.2em; opacity: 0.9; position: relative; }
        .content { padding: 40px; }
        .section { display: none; animation: fadeIn 0.5s ease-in; }
        .section.active { display: block; }
        .user-info { background: #f8f9fa; padding: 25px; border-radius: 12px; margin-bottom: 30px; border-left: 5px solid #E94A4E; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .user-info h2 { color: #E94A4E; margin-bottom: 10px; font-size: 1.5em; }
        .user-info p { color: #666; font-size: 1.1em; }
        .position-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; margin: 30px 0; }
        .position-btn { padding: 20px 15px; border: 2px solid #e0e0e0; border-radius: 10px; background: white; cursor: pointer; transition: all 0.3s ease; font-size: 17px; font-weight: 600; color: #333; display: flex; align-items: center; justify-content: center; text-align: center; min-height: 80px; }
        .position-btn:hover { transform: translateY(-5px); border-color: #E94A4E; box-shadow: 0 10px 20px rgba(233, 74, 78, 0.15); }
        .position-btn.selected { background: #E94A4E; color: white; border-color: #E94A4E; box-shadow: 0 5px 15px rgba(233, 74, 78, 0.3); }
        .btn-primary { background: linear-gradient(to right, #E94A4E, #d63c40); color: white; border: none; padding: 16px 45px; border-radius: 50px; font-size: 18px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-block; margin-top: 20px; box-shadow: 0 4px 15px rgba(233, 74, 78, 0.3); }
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(233, 74, 78, 0.4); background: linear-gradient(to right, #d63c40, #c53034); }
        .btn-primary:disabled { background: #cccccc; cursor: not-allowed; transform: none; box-shadow: none; }
        .btn-secondary { background: #F7F7F7; color: #E94A4E; border: 2px solid #E94A4E; padding: 14px 35px; border-radius: 50px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-block; margin: 10px; }
        .btn-secondary:hover { background: #E94A4E; color: white; }
        .video-container { margin: 30px 0; border-radius: 12px; overflow: hidden; box-shadow: 0 15px 35px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; }
        .test-container { background: #f8f9fa; padding: 30px; border-radius: 12px; margin: 30px 0; border: 1px solid #e0e0e0; }
        .question { margin-bottom: 30px; padding-bottom: 25px; border-bottom: 1px solid #e0e0e0; }
        .question:last-child { border-bottom: none; }
        .question h3 { margin-bottom: 20px; color: #333; font-size: 1.3em; line-height: 1.4; }
        .answers { display: grid; gap: 12px; }
        .answer { background: white; padding: 18px 20px; border-radius: 10px; cursor: pointer; border: 2px solid transparent; transition: all 0.3s ease; display: flex; align-items: center; gap: 15px; font-size: 1.05em; }
        .answer:hover { border-color: #E94A4E; background: #fff5f5; transform: translateX(5px); }
        .answer.selected { background: #E94A4E; color: white; border-color: #d63c40; box-shadow: 0 4px 12px rgba(233, 74, 78, 0.2); }
        .answer-letter { width: 36px; height: 36px; background: #f0f0f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; flex-shrink: 0; transition: all 0.3s ease; }
        .answer.selected .answer-letter { background: white; color: #E94A4E; }
        .progress-bar { height: 12px; background: #e0e0e0; border-radius: 6px; margin: 40px 0; overflow: hidden; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
        .progress { height: 100%; background: linear-gradient(to right, #E94A4E, #FFB700); width: 0%; transition: width 0.5s ease; border-radius: 6px; }
        .completion-message { text-align: center; padding: 50px 40px; background: linear-gradient(135deg, #f9f9f9 0%, #ffffff 100%); border-radius: 15px; margin: 30px 0; display: none; border: 2px dashed #E94A4E; }
        .completion-message.active { display: block; animation: fadeIn 0.5s ease-in; }
        .completion-message h2 { color: #E94A4E; margin-bottom: 25px; font-size: 2.2em; }
        .completion-details { background: white; padding: 25px; border-radius: 12px; margin: 25px auto; max-width: 600px; text-align: left; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .completion-details p { margin: 15px 0; font-size: 1.1em; color: #333; display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f0f0f0; }
        .completion-details p:last-child { border-bottom: none; }
        .completion-details strong { color: #E94A4E; min-width: 200px; display: inline-block; }
        .error-message { background: #fff5f5; border: 2px solid #ff4444; border-radius: 10px; padding: 25px; margin: 25px 0; text-align: center; color: #d63c40; }
        .error-message h3 { color: #ff4444; margin-bottom: 15px; }
        .retry-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; flex-wrap: wrap; }
        .timer { position: fixed; top: 20px; right: 20px; background: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); font-weight: 700; color: #E94A4E; border: 2px solid #E94A4E; z-index: 1000; font-size: 1.1em; display: flex; align-items: center; gap: 10px; }
        .timer::before { content: '‚è±Ô∏è'; font-size: 1.2em; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .success-check { font-size: 4em; margin-bottom: 20px; animation: pulse 2s infinite; }
        @media (max-width: 768px) { .content { padding: 25px; } .position-buttons { grid-template-columns: 1fr; } .header h1 { font-size: 1.8em; } .timer { top: 10px; right: 10px; padding: 12px 20px; font-size: 1em; } .completion-details p { flex-direction: column; gap: 5px; } .completion-details strong { min-width: auto; } }
        @media (max-width: 480px) { .content { padding: 20px; } .header { padding: 25px 20px; } .question h3 { font-size: 1.2em; } .answer { padding: 15px; font-size: 1em; } .btn-primary, .btn-secondary { width: 100%; margin: 5px 0; } }
    </style>
</head>
<body>
    <div class="timer" id="timer">00:00:00</div>
    <div class="container">
        <div class="header">
            <h1>–°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞</h1>
            <p>–ü—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</p>
        </div>
        <div class="content">
            <!-- –≠—Ç–∞–ø 1: –í–≤–æ–¥ –§–ò–û -->
            <div class="section active" id="section-name">
                <div class="user-info">
                    <h2>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ</h2>
                    <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –§–ò–û –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—É—á–µ–Ω–∏—è</p>
                </div>
                <form id="name-form" onsubmit="event.preventDefault(); saveName();">
                    <div style="margin: 30px 0;">
                        <input type="text" id="full-name" placeholder="–í–∞—à –§–ò–û" style="width: 100%; padding: 18px 20px; font-size: 18px; border: 2px solid #e0e0e0; border-radius: 12px; transition: all 0.3s ease;" onfocus="this.style.borderColor='#E94A4E'; this.style.boxShadow='0 0 0 3px rgba(233, 74, 78, 0.1)';" onblur="this.style.borderColor='#e0e0e0'; this.style.boxShadow='none';">
                    </div>
                    <div style="text-align: center;">
                        <button type="submit" class="btn-primary">–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
                    </div>
                </form>
            </div>

<!-- –≠—Ç–∞–ø 2: –í—ã–±–æ—Ä –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ ‚Äî —Ç–æ–ª—å–∫–æ –°–±–æ—Ä—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç -->
<div class="section" id="section-position">
    <div class="user-info">
        <h2 id="user-greeting"></h2>
        <p id="start-time"></p>
    </div>
    <h2 style="color: #333; margin-bottom: 20px; font-size: 1.8em;">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É –¥–æ–ª–∂–Ω–æ—Å—Ç—å:</h2>
    <div class="position-buttons">
        <button class="position-btn disabled-btn" data-position="–ö–∞—Å—Å–∏—Ä" disabled>–ö–∞—Å—Å–∏—Ä</button>
        <button class="position-btn" data-position="–°–±–æ—Ä—â–∏–∫" id="sborshchik-btn">–°–±–æ—Ä—â–∏–∫</button>
        <button class="position-btn disabled-btn" data-position="–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–º–µ–Ω—ã" disabled>–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–º–µ–Ω—ã</button>
        <button class="position-btn disabled-btn" data-position="–†–∞–∑–¥–∞—á–∞" disabled>–†–∞–∑–¥–∞—á–∞</button>
        <button class="position-btn disabled-btn" data-position="–ö—É—Ä—å–µ—Ä" disabled>–ö—É—Ä—å–µ—Ä</button>
    </div>
    <div style="text-align: center;">
        <button id="select-position-btn" class="btn-primary" disabled onclick="selectPosition()">–í—ã–±—Ä–∞—Ç—å –¥–æ–ª–∂–Ω–æ—Å—Ç—å</button>
    </div>
</div>

            <!-- –≠—Ç–∞–ø 3: –ü–µ—Ä–≤–æ–µ –≤–∏–¥–µ–æ -->
            <div class="section" id="section-video1">
                <div class="user-info">
                    <h2>–û–±—É—á–µ–Ω–∏–µ –¥–ª—è –¥–æ–ª–∂–Ω–æ—Å—Ç–∏: <span id="current-position"></span></h2>
                    <p>–°–æ—Ç—Ä—É–¥–Ω–∏–∫: <span id="current-user"></span></p>
                </div>
                <h2 style="color: #333; margin-bottom: 25px; font-size: 1.8em;">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ:</h2>
                <div class="video-container">
                    <iframe width="100%" height="500" src="https://www.youtube.com/embed/FUNWK35AGy8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" onclick="startTest1()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç—É</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 4: –ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç -->
            <div class="section" id="section-test1">
                <div class="test-container">
                    <h2 style="color: #E94A4E; margin-bottom: 15px; font-size: 2em;">–¢–µ—Å—Ç ‚Ññ1</h2>
                    <p style="color: #666; margin-bottom: 25px; font-size: 1.1em;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã. –î–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã.</p>
                    <div class="progress-bar">
                        <div class="progress" id="test1-progress"></div>
                    </div>
                    <div id="test1-questions"></div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="submit-test1" class="btn-primary" onclick="submitTest1()" disabled>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–µ—Å—Ç–∞ 1 -->
            <div id="test1-error" class="error-message" style="display: none;">
                <h3>‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</h3>
                <p>–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
                <div class="retry-buttons">
                    <button class="btn-secondary" onclick="retryVideo1()">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ</button>
                    <button class="btn-primary" onclick="retryTest1()">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 5: –í—Ç–æ—Ä–æ–µ –≤–∏–¥–µ–æ -->
            <div class="section" id="section-video2">
                <div class="user-info">
                    <h2>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è</h2>
                    <p>–ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω</p>
                </div>
                <h2 style="color: #333; margin-bottom: 25px; font-size: 1.8em;">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤—Ç–æ—Ä–æ–µ –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ:</h2>
                <div class="video-container">
                    <iframe width="100%" height="500" src="https://www.youtube.com/embed/EwXtuZ8qswc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" onclick="startTest2()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç—É</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 6: –í—Ç–æ—Ä–æ–π —Ç–µ—Å—Ç -->
            <div class="section" id="section-test2">
                <div class="test-container">
                    <h2 style="color: #E94A4E; margin-bottom: 15px; font-size: 2em;">–¢–µ—Å—Ç ‚Ññ2</h2>
                    <p style="color: #666; margin-bottom: 25px; font-size: 1.1em;">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –≤—Ç–æ—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞</p>
                    <div class="progress-bar">
                        <div class="progress" id="test2-progress"></div>
                    </div>
                    <div id="test2-questions"></div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="submit-test2" class="btn-primary" onclick="submitTest2()" disabled>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–µ—Å—Ç–∞ 2 -->
            <div id="test2-error" class="error-message" style="display: none;">
                <h3>‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</h3>
                <p>–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
                <div class="retry-buttons">
                    <button class="btn-secondary" onclick="retryVideo2()">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ</button>
                    <button class="btn-primary" onclick="retryTest2()">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 7: –¢—Ä–µ—Ç—å–µ –≤–∏–¥–µ–æ (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-video3">
                <div class="user-info">
                    <h2>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è</h2>
                    <p>–í—Ç–æ—Ä–æ–π —Ç–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω</p>
                </div>
                <h2 style="color: #333; margin-bottom: 25px; font-size: 1.8em;">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç—Ä–µ—Ç—å–µ –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ:</h2>
                <div class="video-container">
                    <iframe width="100%" height="500" src="https://www.youtube.com/embed/IEM_VoKW2Nw" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" onclick="startTest3()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç—É</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 8: –¢—Ä–µ—Ç–∏–π —Ç–µ—Å—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-test3">
                <div class="test-container">
                    <h2 style="color: #E94A4E; margin-bottom: 15px; font-size: 2em;">–¢–µ—Å—Ç ‚Ññ3</h2>
                    <p style="color: #666; margin-bottom: 25px; font-size: 1.1em;">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —Ç—Ä–µ—Ç—å–µ–≥–æ —Ç–µ—Å—Ç–∞</p>
                    <div class="progress-bar">
                        <div class="progress" id="test3-progress"></div>
                    </div>
                    <div id="test3-questions"></div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="submit-test3" class="btn-primary" onclick="submitTest3()" disabled>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–µ—Å—Ç–∞ 3 (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div id="test3-error" class="error-message" style="display: none;">
                <h3>‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</h3>
                <p>–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
                <div class="retry-buttons">
                    <button class="btn-secondary" onclick="retryVideo3()">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ</button>
                    <button class="btn-primary" onclick="retryTest3()">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 9: –ß–µ—Ç–≤–µ—Ä—Ç–æ–µ –≤–∏–¥–µ–æ (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-video4">
                <div class="user-info">
                    <h2>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è</h2>
                    <p>–¢—Ä–µ—Ç–∏–π —Ç–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω</p>
                </div>
                <h2 style="color: #333; margin-bottom: 25px; font-size: 1.8em;">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á–µ—Ç–≤–µ—Ä—Ç–æ–µ –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ:</h2>
                <div class="video-container">
                    <iframe width="100%" height="500" src="https://www.youtube.com/embed/L03s4sDC8KA" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" onclick="startTest4()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç—É</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 10: –ß–µ—Ç–≤–µ—Ä—Ç—ã–π —Ç–µ—Å—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-test4">
                <div class="test-container">
                    <h2 style="color: #E94A4E; margin-bottom: 15px; font-size: 2em;">–¢–µ—Å—Ç ‚Ññ4</h2>
                    <p style="color: #666; margin-bottom: 25px; font-size: 1.1em;">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —á–µ—Ç–≤–µ—Ä—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞</p>
                    <div class="progress-bar">
                        <div class="progress" id="test4-progress"></div>
                    </div>
                    <div id="test4-questions"></div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="submit-test4" class="btn-primary" onclick="submitTest4()" disabled>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–µ—Å—Ç–∞ 4 (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div id="test4-error" class="error-message" style="display: none;">
                <h3>‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</h3>
                <p>–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
                <div class="retry-buttons">
                    <button class="btn-secondary" onclick="retryVideo4()">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ</button>
                    <button class="btn-primary" onclick="retryTest4()">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 11: –ü—è—Ç–æ–µ –≤–∏–¥–µ–æ (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-video5">
                <div class="user-info">
                    <h2>–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è</h2>
                    <p>–ß–µ—Ç–≤–µ—Ä—Ç—ã–π —Ç–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–π–¥–µ–Ω</p>
                </div>
                <h2 style="color: #333; margin-bottom: 25px; font-size: 1.8em;">–ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø—è—Ç–æ–µ –æ–±—É—á–∞—é—â–µ–µ –≤–∏–¥–µ–æ:</h2>
                <div class="video-container">
                    <iframe width="100%" height="500" src="https://www.youtube.com/embed/S2GQVPNhyt8" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" onclick="startTest5()">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–µ—Å—Ç—É</button>
                </div>
            </div>

            <!-- –≠—Ç–∞–ø 12: –ü—è—Ç—ã–π —Ç–µ—Å—Ç (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div class="section" id="section-test5">
                <div class="test-container">
                    <h2 style="color: #E94A4E; margin-bottom: 15px; font-size: 2em;">–¢–µ—Å—Ç ‚Ññ5</h2>
                    <p style="color: #666; margin-bottom: 25px; font-size: 1.1em;">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø—è—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞</p>
                    <div class="progress-bar">
                        <div class="progress" id="test5-progress"></div>
                    </div>
                    <div id="test5-questions"></div>
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="submit-test5" class="btn-primary" onclick="submitTest5()" disabled>–ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ</button>
                    </div>
                </div>
            </div>

            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Ç–µ—Å—Ç–∞ 5 (–¥–æ–±–∞–≤–ª–µ–Ω–æ) -->
            <div id="test5-error" class="error-message" style="display: none;">
                <h3>‚ùå –¢–µ—Å—Ç –Ω–µ –ø—Ä–æ–π–¥–µ–Ω</h3>
                <p>–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–ø—Ä–æ—Å—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–∏–¥–µ–æ –µ—â–µ —Ä–∞–∑ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.</p>
                <div class="retry-buttons">
                    <button class="btn-secondary" onclick="retryVideo5()">–°–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –∑–∞–Ω–æ–≤–æ</button>
                    <button class="btn-primary" onclick="retryTest5()">–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑</button>
                </div>
            </div>

            <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–æ—Å–ª–µ 5-–≥–æ —Ç–µ—Å—Ç–∞) -->
            <div class="completion-message" id="completion-message">
                <div class="success-check">üéâ</div>
                <h2>–û–±—É—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!</h2>
                <div class="completion-details">
                    <p><strong>–°–æ—Ç—Ä—É–¥–Ω–∏–∫:</strong> <span id="final-user"></span></p>
                    <p><strong>–î–æ–ª–∂–Ω–æ—Å—Ç—å:</strong> <span id="final-position"></span></p>
                    <p><strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞:</strong> <span id="final-start"></span></p>
                    <p><strong>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:</strong> <span id="final-end"></span></p>
                    <p><strong>–û–±—â–µ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:</strong> <span id="total-time"></span></p>
                </div>
                <p style="font-size: 1.1em; color: #666; margin-top: 30px; max-width: 600px; margin-left: auto; margin-right: auto;">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ. –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å —É—Å–ø–µ—à–Ω—ã–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ–º –æ–±—É—á–µ–Ω–∏—è!</p>
            </div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ -->
    <button onclick="showPasswordPrompt()" style="position: fixed; bottom: 20px; left: 20px; padding: 12px 20px; background: #E94A4E; color: white; border: none; border-radius: 50px; z-index: 9999; font-weight: 600; box-shadow: 0 4px 15px rgba(233, 74, 78, 0.3); cursor: pointer; transition: all 0.3s ease;">üìä –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</button>

    <script>
        // –î–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–∏—è
        let trainingData = {
            fullName: '',
            position: '',
            startTime: null,
            endTime: null,
            test1Score: 0,
            test2Score: 0,
            test3Score: 0,
            test4Score: 0,
            test5Score: 0
        };
// –°—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –¥–ª—è –∞–¥–º–∏–Ω–∞
let errorCounter = {
    test1: 0,
    test2: 0,
    test3: 0,
    test4: 0,
    test5: 0,
    total: 0
};
        // –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤
        const test1Questions = [
            { question: "1. –° –∫–∞–∫–æ–π —Å—Ç–æ—Ä–æ–Ω—ã —á–∏—Ç–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç?", answers: ["–°–≤–µ—Ä—Ö—É –≤–Ω–∏–∑", "–°–Ω–∏–∑—É –≤–≤–µ—Ä—Ö", "–°–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ", "–°–ø—Ä–∞–≤–∞ –Ω–∞–ª–µ–≤–æ"], correct: 1 },
            { question: "2. –ö–∞–∫–æ–π –≤–∏–¥ —à–∞—É—Ä–º—ã –µ—Å—Ç—å?", answers: ["–ú–∏–Ω–∏, —Å—Ä–µ–¥–Ω–∏–π, –±–æ–ª—å—à–æ–π", "–°—Ä–µ–¥–Ω–∏–π, –±–æ–ª—å—à–æ–π", "–ú–∞–ª–µ–Ω—å–∫–∏–π, –±–æ–ª—å—à–æ–π", "–ü–æ–ª–æ–≤–∏–Ω–∫–∞, –±–æ–ª—å—à–∞—è"], correct: 0 }
        ];
        const test2Questions = [
            { question: "1. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–∫–æ–ª—å–∫–æ –ª–∞–≤–∞—à–∞ –º–æ–∂–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å—Å—è –Ω–∞ —Å—Ç–æ–ª–µ?", answers: ["1", "2", "3", "4"], correct: 1 },
            { question: "2. –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–∞–≤–∞—à–∞ –Ω–∞ —à–∞–±–ª–æ–Ω–µ —Å –º–µ—Ç–∫–∞–º–∏:", answers: ["–õ–∞–≤–∞—à –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∫–æ–Ω—Ç—É—Ä–æ–º, –Ω–µ –≤—ã—Ö–æ–¥—è –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã", "–ö—Ä–∞–π –ª–∞–≤–∞—à–∞ –¥–æ–ª–∂–µ–Ω –≤—ã—Ö–æ–¥–∏—Ç—å –∑–∞ –∫–æ–Ω—Ç—É—Ä —Å–ø—Ä–∞–≤–∞", "–õ–∞–≤–∞—à –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É –∫–æ–Ω—Ç—É—Ä–∞", "–õ–∞–≤–∞—à —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ ‚Äî –º–µ—Ç–∫–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è"], correct: 0 }
        ];
        const test3Questions = [
            { question: "–ü–æ—Å–ª–µ –ª–∞–≤–∞—à–∞ —á—Ç–æ –ª–æ–∂–∏—Ç—Å—è?", answers: ["–õ—É–∫", "–ü–æ–º–∏–¥–æ—Ä", "–ö–∞—Ä—Ç–æ—à–∫–∞", "–°–æ—É—Å"], correct: 2 },
            { question: "–°–∫–æ–ª—å–∫–æ –≥—Ä–∞–º–º –º—è—Å–∞ –¥–ª—è —Å—Ä–µ–¥–Ω–µ–π —à–∞—É—Ä–º—ã?", answers: ["90", "80", "70", "130"], correct: 0 }
        ];
        const test4Questions = [
            { question: "–°–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –Ω–∞–¥–æ –ø–æ–¥–∂–∞—Ä–∏—Ç—å —à–∞—É—Ä–º—É?", answers: ["1 –º–∏–Ω –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É", "2 –º–∏–Ω –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É", "3 –º–∏–Ω –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É", "4 –º–∏–Ω –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É"], correct: 1 },
            { question: "–ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –∏–ª–∏ –≤—ã —Å–ø–µ—à–∏—Ç–µ, —Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –º–æ–∂–Ω–æ –ø–æ–¥–∂–∞—Ä–∏—Ç—å —à–∞—É—Ä–º—É?", answers: ["1 –º–∏–Ω –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É", "30 —Å–µ–∫ –∫–∞–∂–¥—É—é —Å—Ç–æ—Ä–æ–Ω—É", "–ù–µ –Ω–∞–¥–æ –∂–∞—Ä–∏—Ç—å", "–ù–∞–¥–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∂–∞—Ä–∏—Ç—å –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É"], correct: 3 }
        ];
        const test5Questions = [
            { question: "–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —Å–¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ —Å–æ–±—Ä–∞–ª–∏ —à–∞—É—Ä–º—É –Ω–µ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É?", answers: ["–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å", "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å", "–†–∞–∑–æ–±—Ä–∞—Ç—å"], correct: 0 },
            { question: "–ï—Å–ª–∏ –≤–µ—Å—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ –∏–ª–∏ –º–µ–Ω—å—à–µ 0 —Ç–æ —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?", answers: ["–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å", "–ó–∞–º–µ–Ω–∏—Ç—å –≤–µ—Å—ã", "–°–æ–æ–±—â–∏—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É", "–ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É —Å–±—Ä–æ—Å–∞ –ø–æ–∫–∞ –Ω–µ –ø–æ–∫–∞–∂–µ—Ç 0"], correct: 3 }
        ];

        // –¢–∞–π–º–µ—Ä
        let startTimestamp = null;
        let timerInterval = null;
        function updateTimer() {
            if (!startTimestamp) return;
            const now = new Date();
            const diff = now - startTimestamp;
            const hours = Math.floor(diff / 3600000).toString().padStart(2, '0');
            const minutes = Math.floor((diff % 3600000) / 60000).toString().padStart(2, '0');
            const seconds = Math.floor((diff % 60000) / 1000).toString().padStart(2, '0');
            document.getElementById('timer').textContent = `${hours}:${minutes}:${seconds}`;
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –§–ò–û
        function saveName() {
            const fullName = document.getElementById('full-name').value.trim();
            if (!fullName) { alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –§–ò–û'); return; }
            trainingData.fullName = fullName;
            trainingData.startTime = new Date();
            startTimestamp = trainingData.startTime;
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer();
            document.getElementById('user-greeting').textContent = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${fullName}!`;
            document.getElementById('start-time').textContent = `–ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è: ${trainingData.startTime.toLocaleString('ru-RU')}`;
            localStorage.setItem('lastUserName', fullName);
            showSection('section-position');
        }

        // –í—ã–±–æ—Ä –¥–æ–ª–∂–Ω–æ—Å—Ç–∏
        let selectedPosition = null;
        document.querySelectorAll('.position-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.position-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                selectedPosition = this.dataset.position;
                document.getElementById('select-position-btn').disabled = false;
                this.style.animation = 'pulse 0.5s';
                setTimeout(() => { this.style.animation = ''; }, 500);
            });
        });

        function selectPosition() {
            if (!selectedPosition) return;
            trainingData.position = selectedPosition;
            document.getElementById('current-position').textContent = selectedPosition;
            document.getElementById('current-user').textContent = trainingData.fullName;
            document.getElementById('final-position').textContent = selectedPosition;
            document.getElementById('final-user').textContent = trainingData.fullName;
            showSection('section-video1');
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
            document.querySelectorAll('.error-message').forEach(err => err.style.display = 'none');
            document.getElementById(sectionId).classList.add('active');
            window.scrollTo(0, 0);
        }

        // –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç—ã
        function startTest1() { showSection('section-test1'); renderTestQuestions('test1-questions', test1Questions, 'test1'); }
        function startTest2() { showSection('section-test2'); renderTestQuestions('test2-questions', test2Questions, 'test2'); }
        function startTest3() { showSection('section-test3'); renderTestQuestions('test3-questions', test3Questions, 'test3'); }
        function startTest4() { showSection('section-test4'); renderTestQuestions('test4-questions', test4Questions, 'test4'); }
        function startTest5() { showSection('section-test5'); renderTestQuestions('test5-questions', test5Questions, 'test5'); }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤
        function renderTestQuestions(containerId, questions, testPrefix) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            const letters = ['–∞', '–±', '–≤', '–≥'];
            questions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                let answersHTML = '';
                q.answers.forEach((answer, ansIndex) => {
                    answersHTML += `
                        <div class="answer" data-question="${index}" data-answer="${ansIndex}">
                            <div class="answer-letter">${letters[ansIndex]}</div>
                            <div class="answer-text">${answer}</div>
                        </div>`;
                });
                questionDiv.innerHTML = `
                    <h3>${q.question}</h3>
                    <div class="answers">${answersHTML}</div>`;
                container.appendChild(questionDiv);
            });
            document.querySelectorAll(`#${containerId} .answer`).forEach(answer => {
                answer.addEventListener('click', function() {
                    const questionIndex = parseInt(this.dataset.question);
                    const answerIndex = parseInt(this.dataset.answer);
                    this.parentElement.querySelectorAll('.answer').forEach(a => a.classList.remove('selected'));
                    this.classList.add('selected');
                    questions[questionIndex].selected = answerIndex;
                    checkTestCompletion(questions, testPrefix);
                });
            });
            document.getElementById(`${testPrefix}-progress`).style.width = '0%';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
        function checkTestCompletion(questions, testPrefix) {
            const allAnswered = questions.every(q => q.selected !== undefined);
            const submitBtn = document.getElementById(`submit-${testPrefix}`);
            submitBtn.disabled = !allAnswered;
            if (allAnswered) document.getElementById(`${testPrefix}-progress`).style.width = '100%';
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Å—Ç–æ–≤
function submitTest1() {
    let score = 0;
    test1Questions.forEach(q => { if (q.selected === q.correct) score++; });
    trainingData.test1Score = score;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –í–ù–£–¢–†–ò —Ñ—É–Ω–∫—Ü–∏–∏
    if (score !== test1Questions.length) {
        errorCounter.test1++;
        errorCounter.total++;
    }
    
    if (score === test1Questions.length) showSection('section-video2');
    else document.getElementById('test1-error').style.display = 'block';
}
function submitTest2() {
    let score = 0;
    test2Questions.forEach(q => { if (q.selected === q.correct) score++; });
    trainingData.test2Score = score;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –í–ù–£–¢–†–ò —Ñ—É–Ω–∫—Ü–∏–∏
    if (score !== test2Questions.length) {
        errorCounter.test2++;
        errorCounter.total++;
    }
    
    if (score === test2Questions.length) showSection('section-video3');
    else document.getElementById('test2-error').style.display = 'block';
}
function submitTest3() {
    let score = 0;
    test3Questions.forEach(q => { if (q.selected === q.correct) score++; });
    trainingData.test3Score = score;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –í–ù–£–¢–†–ò —Ñ—É–Ω–∫—Ü–∏–∏
    if (score !== test3Questions.length) {
        errorCounter.test3++;
        errorCounter.total++;
    }
    
    if (score === test3Questions.length) showSection('section-video4');
    else document.getElementById('test3-error').style.display = 'block';
}
function submitTest4() {
    let score = 0;
    test4Questions.forEach(q => { if (q.selected === q.correct) score++; });
    trainingData.test4Score = score;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –í–ù–£–¢–†–ò —Ñ—É–Ω–∫—Ü–∏–∏
    if (score !== test4Questions.length) {
        errorCounter.test4++;
        errorCounter.total++;
    }
    
    if (score === test4Questions.length) showSection('section-video5');
    else document.getElementById('test4-error').style.display = 'block';
}
function submitTest5() {
    let score = 0;
    test5Questions.forEach(q => { if (q.selected === q.correct) score++; });
    trainingData.test5Score = score;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –í–ù–£–¢–†–ò —Ñ—É–Ω–∫—Ü–∏–∏
    if (score !== test5Questions.length) {
        errorCounter.test5++;
        errorCounter.total++;
    }
    
    if (score === test5Questions.length) {
        trainingData.endTime = new Date();
        completeTraining();
    } else document.getElementById('test5-error').style.display = 'block';
}
        // –§—É–Ω–∫—Ü–∏–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
        function retryVideo1() { showSection('section-video1'); }
        function retryTest1() { test1Questions.forEach(q => { q.selected = undefined; }); startTest1(); }
        function retryVideo2() { showSection('section-video2'); }
        function retryTest2() { test2Questions.forEach(q => { q.selected = undefined; }); startTest2(); }
        function retryVideo3() { showSection('section-video3'); }
        function retryTest3() { test3Questions.forEach(q => { q.selected = undefined; }); startTest3(); }
        function retryVideo4() { showSection('section-video4'); }
        function retryTest4() { test4Questions.forEach(q => { q.selected = undefined; }); startTest4(); }
        function retryVideo5() { showSection('section-video5'); }
        function retryTest5() { test5Questions.forEach(q => { q.selected = undefined; }); startTest5(); }
// –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
function completeTraining() {
    clearInterval(timerInterval);
    const totalTime = trainingData.endTime - trainingData.startTime;
    const hours = Math.floor(totalTime / 3600000);
    const minutes = Math.floor((totalTime % 3600000) / 60000);
    const seconds = Math.floor((totalTime % 60000) / 1000);
    document.getElementById('final-start').textContent = trainingData.startTime.toLocaleString('ru-RU');
    document.getElementById('final-end').textContent = trainingData.endTime.toLocaleString('ru-RU');
    document.getElementById('total-time').textContent = `${hours} —á ${minutes} –º–∏–Ω ${seconds} —Å–µ–∫`;
    document.getElementById('completion-message').classList.add('active');
    saveTrainingData();
    
    // –û–±–Ω—É–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    errorCounter = {
        test1: 0,
        test2: 0,
        test3: 0,
        test4: 0,
        test5: 0,
        total: 0
    };
}
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
function saveTrainingData() {
    const allTrainings = JSON.parse(localStorage.getItem('trainingRecords') || '[]');
    const record = { 
        ...trainingData, 
        startTime: trainingData.startTime.toISOString(), 
        endTime: trainingData.endTime.toISOString(), 
        completed: true,
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫
        totalErrors: errorCounter.total
    };
    allTrainings.push(record);
    localStorage.setItem('trainingRecords', JSON.stringify(allTrainings));
    console.log('–î–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:', record);
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ—à–∏–±–æ–∫
    const errorStats = JSON.parse(localStorage.getItem('errorStats') || '{}');
    errorStats[trainingData.fullName] = {
        ...errorCounter,
        timestamp: new Date().toISOString(),
        position: trainingData.position
    };
    localStorage.setItem('errorStats', JSON.stringify(errorStats));
}
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            const savedName = localStorage.getItem('lastUserName');
            if (savedName) document.getElementById('full-name').value = savedName;
            setTimeout(() => { const nameInput = document.getElementById('full-name'); if (nameInput) nameInput.focus(); }, 300);
        });

        // –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —à–∞–±–ª–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏)
        const ADMIN_PASSWORD = "1616";
        document.addEventListener('DOMContentLoaded', function() {
            const adminBtn = document.querySelector('button[onclick="showPasswordPrompt()"]');
            if (adminBtn) {
                adminBtn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-3px)';
                    this.style.boxShadow = '0 8px 25px rgba(233, 74, 78, 0.4)';
                });
                adminBtn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 4px 15px rgba(233, 74, 78, 0.3)';
                });
            }
        });
        function showPasswordPrompt() {
            let html = `
                <div id="password-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; display: flex; justify-content: center; align-items: center;">
                    <div style="background: white; padding: 40px; border-radius: 15px; max-width: 400px; width: 90%; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                        <h2 style="color: #E94A4E; margin-bottom: 20px;">üîê –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏</h2>
                        <p style="margin-bottom: 20px; color: #666;">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞–ø–∏—Å–µ–π:</p>
                        <input type="password" id="admin-password-input" style="width: 100%; padding: 15px; font-size: 18px; border: 2px solid #E94A4E; border-radius: 8px; margin-bottom: 20px;" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                        <div id="password-error" style="color: #ff4444; margin-bottom: 15px; min-height: 20px;"></div>
                        <div style="display: flex; gap: 10px; justify-content: center;">
                            <button onclick="checkAdminPassword()" style="padding: 12px 30px; background: #E94A4E; color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: 600;">–í–æ–π—Ç–∏</button>
                            <button onclick="closePasswordModal()" style="padding: 12px 30px; background: #ccc; color: #333; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: 600;">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </div>
                </div>`;
            const existingModal = document.getElementById('password-modal');
            if (existingModal) existingModal.remove();
            document.body.insertAdjacentHTML('beforeend', html);
            setTimeout(() => {
                const input = document.getElementById('admin-password-input');
                if (input) {
                    input.focus();
                    input.addEventListener('input', function() { this.value = this.value.replace(/\D/g, ''); });
                }
            }, 100);
        }
        function closePasswordModal() {
            const modal = document.getElementById('password-modal');
            if (modal) modal.remove();
        }
        function checkAdminPassword() {
            const input = document.getElementById('admin-password-input');
            const errorDiv = document.getElementById('password-error');
            if (!input) return;
            const enteredPassword = input.value;
            if (enteredPassword === ADMIN_PASSWORD) {
                closePasswordModal();
                showAdminPanel();
            } else {
                input.style.borderColor = '#ff4444';
                input.style.animation = 'shake 0.5s';
                if (errorDiv) errorDiv.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
                input.value = '';
                input.focus();
                setTimeout(() => { input.style.animation = ''; }, 500);
            }
        }
        if (!document.querySelector('style#admin-styles')) {
            const style = document.createElement('style');
            style.id = 'admin-styles';
            style.textContent = `
                @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }
                #admin-password-input:focus { outline: none; border-color: #E94A4E; box-shadow: 0 0 0 3px rgba(233, 74, 78, 0.2); }
                @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
                @keyframes slideOut { from { transform: translateX(0); opacity: 1; } to { transform: translateX(100%); opacity: 0; } }`;
            document.head.appendChild(style);
        }
        document.addEventListener('keydown', function(e) {
            const passwordInput = document.getElementById('admin-password-input');
            if (passwordInput && e.key === 'Enter') checkAdminPassword();
        });
function showAdminPanel() {
    let allTrainings = [];
    try {
        const storedData = localStorage.getItem('trainingRecords');
        if (storedData) allTrainings = JSON.parse(storedData);
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage:', e);
    }
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–≤–µ—Ä—Ö—É
    const totalErrorsAll = allTrainings.reduce((sum, record) => sum + (record.totalErrors || 0), 0);
    const avgErrors = allTrainings.length > 0 ? (totalErrorsAll / allTrainings.length).toFixed(1) : '0';
    
    let html = `
        <div id="admin-panel" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10000; padding: 20px; overflow-y: auto;">
            <div style="background: white; padding: 30px; border-radius: 15px; max-width: 1200px; margin: 0 auto; position: relative;">
                <button onclick="closeAdminPanel()" style="position: absolute; top: 15px; right: 15px; background: #ff4444; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2 style="color: #E94A4E; margin: 0; font-size: 1.8em;">üìã –í—Å–µ –∑–∞–ø–∏—Å–∏ –æ–±—É—á–µ–Ω–∏—è</h2>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span style="color: #666; font-size: 14px; background: #f0f0f0; padding: 5px 10px; border-radius: 4px;">–ü–∞—Ä–æ–ª—å: 1616</span>
                        <button onclick="refreshAdminData()" style="background: #4a6fa5; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer; font-size: 14px;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                </div>`;
    
    if (allTrainings.length === 0) {
        html += `
            <div style="text-align: center; padding: 60px 20px;">
                <p style="color: #666; font-size: 1.2em; margin-bottom: 20px;">–ó–∞–ø–∏—Å–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</p>
                <p style="color: #999; font-size: 0.9em;">–ü—Ä–æ–π—Ç–∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –Ω–∞ —ç—Ç–æ–π –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü–µ</p>
            </div>`;
    } else {
        const completedTrainings = allTrainings.filter(t => t.test1Score === 2 && t.test2Score === 2 && t.test3Score === 2 && t.test4Score === 2 && t.test5Score === 2).length;
        const successRate = allTrainings.length > 0 ? Math.round(completedTrainings / allTrainings.length * 100) : 0;
        
        html += `
            <div style="margin-bottom: 30px;">
                <p style="color: #E94A4E; font-weight: bold; font-size: 1.1em;">–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: ${allTrainings.length}</p>
                <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
                    <div style="background: #f0f4ff; padding: 15px; border-radius: 8px; flex: 1; min-width: 200px;">
                        <div style="font-size: 0.9em; color: #666;">–£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        <div style="font-size: 1.5em; font-weight: bold; color: #34A853;">${completedTrainings}</div>
                        <div style="font-size: 0.9em; color: #666;">${successRate}% –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞</div>
                    </div>
                    <div style="background: #fff5f5; padding: 15px; border-radius: 8px; flex: 1; min-width: 200px;">
                        <div style="font-size: 0.9em; color: #666;">–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫</div>
                        <div style="font-size: 1.5em; font-weight: bold; color: #E94A4E;">${totalErrorsAll}</div>
                        <div style="font-size: 0.9em; color: #666;">${avgErrors} –≤ —Å—Ä–µ–¥–Ω–µ–º</div>
                    </div>`;
        
        if (allTrainings.length > 0) {
            const lastRecord = allTrainings[allTrainings.length - 1];
            const lastDate = lastRecord.endTime ? new Date(lastRecord.endTime).toLocaleDateString('ru-RU') : '–ù–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
            html += `
                <div style="background: #fff5f5; padding: 15px; border-radius: 8px; flex: 1; min-width: 200px;">
                    <div style="font-size: 0.9em; color: #666;">–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å</div>
                    <div style="font-size: 1.2em; font-weight: bold; color: #E94A4E;">${lastRecord.fullName || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</div>
                    <div style="font-size: 0.9em; color: #666;">${lastDate}</div>
                </div>`;
        }
        
        html += `</div></div>`;
        
        html += `
            <div style="overflow-x: auto; margin-top: 20px; border: 1px solid #e0e0e0; border-radius: 10px;">
                <table style="width: 100%; border-collapse: collapse; min-width: 1000px;">
                    <thead>
                        <tr style="background: linear-gradient(to right, #E94A4E, #d63c40); color: white;">
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">‚Ññ</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–§–ò–û</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–¢–µ—Å—Ç 1</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–¢–µ—Å—Ç 2</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–¢–µ—Å—Ç 3</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–¢–µ—Å—Ç 4</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–¢–µ—Å—Ç 5</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–û—à–∏–±–æ–∫</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left; font-weight: 600;">–°—Ç–∞—Ç—É—Å</th>
                        </tr>
                    </thead>
                    <tbody>`;
        
        allTrainings.forEach((record, index) => {
            const startTime = record.startTime ? new Date(record.startTime).toLocaleString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const endTime = record.endTime ? new Date(record.endTime).toLocaleString('ru-RU') : '–ù–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
            const rowColor = index % 2 === 0 ? '#f8f9fa' : 'white';
            let status = '‚ùì', statusColor = '#FFB700', statusText = '–í –ø—Ä–æ—Ü–µ—Å—Å–µ';
            
            if (record.completed) {
                if (record.test1Score === 2 && record.test2Score === 2 && record.test3Score === 2 && record.test4Score === 2 && record.test5Score === 2) {
                    status = '‚úÖ'; statusColor = '#34A853'; statusText = '–£—Å–ø–µ—à–Ω–æ';
                } else {
                    status = '‚ùå'; statusColor = '#EA4335'; statusText = '–ù–µ –ø—Ä–æ–π–¥–µ–Ω';
                }
            }
            
            const test1Score = record.test1Score || 0;
            const test2Score = record.test2Score || 0;
            const test3Score = record.test3Score || 0;
            const test4Score = record.test4Score || 0;
            const test5Score = record.test5Score || 0;
            const totalErrors = record.totalErrors || 0;
            
            const test1Color = test1Score === 2 ? '#34A853' : test1Score > 0 ? '#FFB700' : '#EA4335';
            const test2Color = test2Score === 2 ? '#34A853' : test2Score > 0 ? '#FFB700' : '#EA4335';
            const test3Color = test3Score === 2 ? '#34A853' : test3Score > 0 ? '#FFB700' : '#EA4335';
            const test4Color = test4Score === 2 ? '#34A853' : test4Score > 0 ? '#FFB700' : '#EA4335';
            const test5Color = test5Score === 2 ? '#34A853' : test5Score > 0 ? '#FFB700' : '#EA4335';
            const errorsColor = totalErrors === 0 ? '#34A853' : totalErrors <= 3 ? '#FFB700' : '#EA4335';
            
            html += `
                <tr style="background-color: ${rowColor}; transition: background-color 0.3s;">
                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold; color: #666;">${index + 1}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: 600;">${record.fullName || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">
                        <span style="display: inline-block; padding: 5px 10px; background: #fff5f5; color: #E94A4E; border-radius: 20px; font-size: 13px; font-weight: 600;">${record.position || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</span>
                    </td>
                    <td style="padding: 12px; border: 1px solid #ddd; color: #666;">${startTime}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; color: #666;">${endTime}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${test1Color}; font-weight: bold; font-size: 1.1em;">${test1Score}/2</span></td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${test2Color}; font-weight: bold; font-size: 1.1em;">${test2Score}/2</span></td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${test3Color}; font-weight: bold; font-size: 1.1em;">${test3Score}/2</span></td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${test4Color}; font-weight: bold; font-size: 1.1em;">${test4Score}/2</span></td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${test5Color}; font-weight: bold; font-size: 1.1em;">${test5Score}/2</span></td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center;">
                        <span style="color: ${errorsColor}; font-weight: bold; font-size: 1.1em; display: inline-block; padding: 3px 10px; background: ${errorsColor}15; border-radius: 20px; border: 1px solid ${errorsColor}30;">
                            ${totalErrors}
                        </span>
                    </td>
                    <td style="padding: 12px; border: 1px solid #ddd;"><span style="color: ${statusColor}; font-weight: bold; display: flex; align-items: center; gap: 5px;">${status} ${statusText}</span></td>
                </tr>`;
        });
        
        html += `</tbody></table></div>`;
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º
        let allErrorStats = {};
        try {
            const storedErrorStats = localStorage.getItem('errorStats');
            if (storedErrorStats) {
                allErrorStats = JSON.parse(storedErrorStats);
            }
        } catch (e) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', e);
        }

        // –ê–≥—Ä–µ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
        const aggregatedErrors = { test1: 0, test2: 0, test3: 0, test4: 0, test5: 0, total: 0 };
        Object.values(allErrorStats).forEach(stats => {
            aggregatedErrors.test1 += stats.test1 || 0;
            aggregatedErrors.test2 += stats.test2 || 0;
            aggregatedErrors.test3 += stats.test3 || 0;
            aggregatedErrors.test4 += stats.test4 || 0;
            aggregatedErrors.test5 += stats.test5 || 0;
            aggregatedErrors.total += stats.total || 0;
        });

        html += `
            <div style="margin-top: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px; border-left: 5px solid #E94A4E;">
                <h3 style="color: #E94A4E; margin-bottom: 20px;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">`;

        const tests = [
            { id: 'test1', name: '–¢–µ—Å—Ç 1', errors: aggregatedErrors.test1 },
            { id: 'test2', name: '–¢–µ—Å—Ç 2', errors: aggregatedErrors.test2 },
            { id: 'test3', name: '–¢–µ—Å—Ç 3', errors: aggregatedErrors.test3 },
            { id: 'test4', name: '–¢–µ—Å—Ç 4', errors: aggregatedErrors.test4 },
            { id: 'test5', name: '–¢–µ—Å—Ç 5', errors: aggregatedErrors.test5 }
        ];

        tests.forEach(test => {
            const percentage = allTrainings.length > 0 ? 
                Math.round((test.errors / (allTrainings.length * 2)) * 100) : 0;
            html += `
                <div style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="font-size: 0.9em; color: #666;">${test.name}</div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                        <div style="font-size: 1.5em; font-weight: bold; color: ${test.errors > 0 ? '#EA4335' : '#34A853'};">${test.errors}</div>
                        <div style="font-size: 0.9em; color: #666;">${percentage}% –æ—à–∏–±–æ–∫</div>
                    </div>
                </div>`;
        });

        html += `
                </div>
                <div style="margin-top: 20px; padding: 15px; background: white; border-radius: 8px; border: 2px solid #E94A4E;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-size: 0.9em; color: #666;">–í—Å–µ–≥–æ –æ—à–∏–±–æ–∫ –≤ —Å–∏—Å—Ç–µ–º–µ</div>
                            <div style="font-size: 2em; font-weight: bold; color: #E94A4E;">${aggregatedErrors.total}</div>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 0.9em; color: #666;">–°—Ä–µ–¥–Ω–µ–µ –Ω–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞</div>
                            <div style="font-size: 1.5em; font-weight: bold; color: #666;">
                                ${allTrainings.length > 0 ? (aggregatedErrors.total / allTrainings.length).toFixed(1) : '0'}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        html += `
            <div style="margin-top: 30px; display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                <button onclick="exportToCSV()" style="padding: 12px 25px; background: #E94A4E; color: white; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600; transition: all 0.3s;">üì• <span>–≠–∫—Å–ø–æ—Ä—Ç –≤ CSV</span></button>
                <button onclick="exportToExcel()" style="padding: 12px 25px; background: #34A853; color: white; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600; transition: all 0.3s;">üìä <span>–≠–∫—Å–ø–æ—Ä—Ç –≤ Excel</span></button>
                <button onclick="clearAllData()" style="padding: 12px 25px; background: #ff4444; color: white; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600; transition: all 0.3s;">üóëÔ∏è <span>–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</span></button>
                <button onclick="showErrorStatistics()" style="padding: 12px 25px; background: #FFB700; color: white; border: none; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-weight: 600; transition: all 0.3s;">üìà <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫</span></button>
            </div>`;
    }
    
    html += `
        <div style="margin-top: 40px; text-align: center; padding-top: 20px; border-top: 1px solid #e0e0e0;">
            <p style="color: #999; font-size: 0.9em;">–°–∏—Å—Ç–µ–º–∞ –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∞ ‚Ä¢ –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ –±–∞–∑–µ: ${allTrainings.length}</p>
        </div>
    </div>
</div>`;
    
    const existingPanel = document.getElementById('admin-panel');
    if (existingPanel) existingPanel.remove();
    document.body.insertAdjacentHTML('beforeend', html);
    
    setTimeout(() => {
        document.querySelectorAll('#admin-panel button').forEach(btn => {
            if (!btn.onclick.toString().includes('closeAdminPanel')) {
                btn.addEventListener('mouseenter', function() { 
                    this.style.transform = 'translateY(-2px)'; 
                    this.style.boxShadow = '0 5px 15px rgba(0,0,0,0.2)'; 
                });
                btn.addEventListener('mouseleave', function() { 
                    this.style.transform = 'translateY(0)'; 
                    this.style.boxShadow = 'none'; 
                });
            }
        });
    }, 100);
}
        function closeAdminPanel() {
            const panel = document.getElementById('admin-panel');
            if (panel) panel.remove();
        }
function refreshAdminData() {
    closeAdminPanel();
    setTimeout(showAdminPanel, 100);
}
function exportToCSV() {
    let allTrainings = [];
    try {
        const storedData = localStorage.getItem('trainingRecords');
        if (storedData) allTrainings = JSON.parse(storedData);
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:', e);
    }
    if (allTrainings.length === 0) { showNotification('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!', 'error'); return; }
    
    let csv = '‚Ññ;–§–ò–û;–î–æ–ª–∂–Ω–æ—Å—Ç—å;–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞;–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è;–¢–µ—Å—Ç1;–¢–µ—Å—Ç2;–¢–µ—Å—Ç3;–¢–µ—Å—Ç4;–¢–µ—Å—Ç5;–û—à–∏–±–æ–∫ –≤—Å–µ–≥–æ;–°—Ç–∞—Ç—É—Å\n';
    
    allTrainings.forEach((record, index) => {
        const startTime = record.startTime ? new Date(record.startTime).toLocaleString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
        const endTime = record.endTime ? new Date(record.endTime).toLocaleString('ru-RU') : '–ù–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ';
        const test1Score = record.test1Score || 0;
        const test2Score = record.test2Score || 0;
        const test3Score = record.test3Score || 0;
        const test4Score = record.test4Score || 0;
        const test5Score = record.test5Score || 0;
        const totalErrors = record.totalErrors || 0;
        
        const status = record.completed ? 
            (test1Score === 2 && test2Score === 2 && test3Score === 2 && test4Score === 2 && test5Score === 2 ? 
             '–£—Å–ø–µ—à–Ω–æ' : '–ù–µ –ø—Ä–æ–π–¥–µ–Ω') : '–í –ø—Ä–æ—Ü–µ—Å—Å–µ';
        
        csv += `${index + 1};"${record.fullName || ''}";"${record.position || ''}";"${startTime}";"${endTime}";${test1Score}/2;${test2Score}/2;${test3Score}/2;${test4Score}/2;${test5Score}/2;${totalErrors};"${status}"\n`;
    }); // –ó–∞–∫—Ä—ã–≤–∞–µ–º forEach –∑–¥–µ—Å—å
    
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.href = url;
    link.download = `–æ–±—É—á–µ–Ω–∏–µ_—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤_${new Date().toISOString().slice(0,10)}.csv`;
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    showNotification('CSV —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —Å–∫–∞—á–∞–Ω!', 'success');
} // –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é exportToCSV –∑–¥–µ—Å—å
function exportToExcel() {
    showNotification('–î–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel —Å–∫–∞—á–∞–π—Ç–µ CSV —Ñ–∞–π–ª –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ Excel', 'info');
    exportToCSV();
}
        function clearAllData() {
            if (confirm('‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï!\n\n–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –æ–±—É—á–µ–Ω–∏—è?\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                const password = prompt('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å 1616 –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è:');
                if (password === ADMIN_PASSWORD) {
                    localStorage.removeItem('trainingRecords');
                    localStorage.removeItem('lastUserName');
                    showNotification('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã!', 'success');
                    setTimeout(() => { closeAdminPanel(); setTimeout(showAdminPanel, 300); }, 1500);
                } else {
                    showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å! –î–∞–Ω–Ω—ã–µ –Ω–µ —É–¥–∞–ª–µ–Ω—ã.', 'error');
                }
            }
        }
        function showNotification(message, type) {
            document.querySelectorAll('.admin-notification').forEach(n => n.remove());
            const colors = { success: '#34A853', error: '#EA4335', info: '#4a6fa5' };
            const notification = document.createElement('div');
            notification.className = 'admin-notification';
            notification.style.cssText = `position: fixed; top: 20px; right: 20px; padding: 15px 25px; background: ${colors[type] || colors.info}; color: white; border-radius: 8px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); z-index: 10001; animation: slideIn 0.3s ease; max-width: 400px; font-weight: 600; display: flex; align-items: center; gap: 10px;`;
            const icons = { success: '‚úÖ', error: '‚ùå', info: '‚ÑπÔ∏è' };
            notification.innerHTML = `${icons[type] || icons.info} <span>${message}</span>`;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => { if (notification.parentNode) document.body.removeChild(notification); }, 300);
            }, 3000);
        }
        document.addEventListener('DOMContentLoaded', function() {
            console.log('–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            console.log('–î–∞–Ω–Ω—ã–µ –≤ localStorage:', localStorage.getItem('trainingRecords'));
        });
function showErrorStatistics() {
    let allErrorStats = {};
    try {
        const storedErrorStats = localStorage.getItem('errorStats');
        if (storedErrorStats) {
            allErrorStats = JSON.parse(storedErrorStats);
        }
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', e);
    }
    
    let html = `
        <div id="error-statistics-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10001; padding: 20px; overflow-y: auto;">
            <div style="background: white; padding: 30px; border-radius: 15px; max-width: 1000px; margin: 0 auto; position: relative;">
                <button onclick="closeErrorStatistics()" style="position: absolute; top: 15px; right: 15px; background: #ff4444; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                <h2 style="color: #E94A4E; margin-bottom: 25px;">üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫</h2>
    `;
    
    if (Object.keys(allErrorStats).length === 0) {
        html += `
            <div style="text-align: center; padding: 60px 20px;">
                <p style="color: #666; font-size: 1.2em;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–∫–∞ –Ω–µ —Å–æ–±—Ä–∞–Ω–∞</p>
            </div>
        `;
    } else {
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—à–∏–±–æ–∫ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
        const sortedStats = Object.entries(allErrorStats)
            .sort((a, b) => b[1].total - a[1].total);
        
        html += `
            <div style="overflow-x: auto; margin-bottom: 30px;">
                <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                    <thead>
                        <tr style="background: linear-gradient(to right, #E94A4E, #d63c40); color: white;">
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 1</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 2</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 3</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 4</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 5</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–í—Å–µ–≥–æ</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–î–∞—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        sortedStats.forEach(([name, stats], index) => {
            const rowColor = index % 2 === 0 ? '#f8f9fa' : 'white';
            const date = stats.timestamp ? new Date(stats.timestamp).toLocaleDateString('ru-RU') : '–ù/–î';
            
            html += `
                <tr style="background-color: ${rowColor};">
                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: 600;">${name}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">${stats.position || '–ù/–î'}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test1 > 0 ? '#EA4335' : '#34A853'}">${stats.test1 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test2 > 0 ? '#EA4335' : '#34A853'}">${stats.test2 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test3 > 0 ? '#EA4335' : '#34A853'}">${stats.test3 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test4 > 0 ? '#EA4335' : '#34A853'}">${stats.test4 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test5 > 0 ? '#EA4335' : '#34A853'}">${stats.test5 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; font-weight: bold; color: ${stats.total > 0 ? '#EA4335' : '#34A853'}">${stats.total || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">${date}</td>
                </tr>
            `;
        });
        
        html += `</tbody></table></div>`;
        
        // –ì—Ä–∞—Ñ–∏–∫ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º
        const testNames = ['–¢–µ—Å—Ç 1', '–¢–µ—Å—Ç 2', '–¢–µ—Å—Ç 3', '–¢–µ—Å—Ç 4', '–¢–µ—Å—Ç 5'];
        const testErrors = [aggregatedErrors.test1, aggregatedErrors.test2, aggregatedErrors.test3, aggregatedErrors.test4, aggregatedErrors.test5];
        const maxErrors = Math.max(...testErrors);
        
        html += `
            <div style="margin-top: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="color: #E94A4E; margin-bottom: 20px;">üìâ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º</h3>
                <div style="display: flex; flex-direction: column; gap: 15px;">
        `;
        
        testNames.forEach((name, index) => {
            const errors = testErrors[index];
            const percentage = maxErrors > 0 ? (errors / maxErrors) * 100 : 0;
            const width = Math.max(10, percentage);
            
            html += `
                <div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="font-weight: 600;">${name}</span>
                        <span style="color: ${errors > 0 ? '#EA4335' : '#34A853'}; font-weight: bold;">${errors}</span>
                    </div>
                    <div style="height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden;">
                        <div style="height: 100%; width: ${width}%; background: linear-gradient(to right, #E94A4E, #FFB700); border-radius: 5px;"></div>
                    </div>
                </div>
            `;
        });
        
        html += `</div></div>`;
    }
    
    html += `
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', html);
}

function closeErrorStatistics() {
    const modal = document.getElementById('error-statistics-modal');
    if (modal) modal.remove();
}   
function showErrorStatistics() {
    let allErrorStats = {};
    try {
        const storedErrorStats = localStorage.getItem('errorStats');
        if (storedErrorStats) {
            allErrorStats = JSON.parse(storedErrorStats);
        }
    } catch (e) {
        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', e);
    }
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è aggregatedErrors
    let aggregatedErrors = { test1: 0, test2: 0, test3: 0, test4: 0, test5: 0, total: 0 };
    Object.values(allErrorStats).forEach(stats => {
        aggregatedErrors.test1 += stats.test1 || 0;
        aggregatedErrors.test2 += stats.test2 || 0;
        aggregatedErrors.test3 += stats.test3 || 0;
        aggregatedErrors.test4 += stats.test4 || 0;
        aggregatedErrors.test5 += stats.test5 || 0;
        aggregatedErrors.total += stats.total || 0;
    });
    
    let html = `
        <div id="error-statistics-modal" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 10001; padding: 20px; overflow-y: auto;">
            <div style="background: white; padding: 30px; border-radius: 15px; max-width: 1000px; margin: 0 auto; position: relative;">
                <button onclick="closeErrorStatistics()" style="position: absolute; top: 15px; right: 15px; background: #ff4444; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center;">√ó</button>
                <h2 style="color: #E94A4E; margin-bottom: 25px;">üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫</h2>
    `;
    
    if (Object.keys(allErrorStats).length === 0) {
        html += `
            <div style="text-align: center; padding: 60px 20px;">
                <p style="color: #666; font-size: 1.2em;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–∫–∞ –Ω–µ —Å–æ–±—Ä–∞–Ω–∞</p>
            </div>
        `;
    } else {
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –æ—à–∏–±–æ–∫ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
        const sortedStats = Object.entries(allErrorStats)
            .sort((a, b) => b[1].total - a[1].total);
        
        html += `
            <div style="overflow-x: auto; margin-bottom: 30px;">
                <table style="width: 100%; border-collapse: collapse; min-width: 800px;">
                    <thead>
                        <tr style="background: linear-gradient(to right, #E94A4E, #d63c40); color: white;">
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 1</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 2</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 3</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 4</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–¢–µ—Å—Ç 5</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–í—Å–µ–≥–æ</th>
                            <th style="padding: 15px; border: 1px solid #ddd; text-align: left;">–î–∞—Ç–∞</th>
                        </tr>
                    </thead>
                    <tbody>
        `;
        
        sortedStats.forEach(([name, stats], index) => {
            const rowColor = index % 2 === 0 ? '#f8f9fa' : 'white';
            const date = stats.timestamp ? new Date(stats.timestamp).toLocaleDateString('ru-RU') : '–ù/–î';
            
            html += `
                <tr style="background-color: ${rowColor};">
                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: 600;">${name}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">${stats.position || '–ù/–î'}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test1 > 0 ? '#EA4335' : '#34A853'}">${stats.test1 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test2 > 0 ? '#EA4335' : '#34A853'}">${stats.test2 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test3 > 0 ? '#EA4335' : '#34A853'}">${stats.test3 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test4 > 0 ? '#EA4335' : '#34A853'}">${stats.test4 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; color: ${stats.test5 > 0 ? '#EA4335' : '#34A853'}">${stats.test5 || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd; text-align: center; font-weight: bold; color: ${stats.total > 0 ? '#EA4335' : '#34A853'}">${stats.total || 0}</td>
                    <td style="padding: 12px; border: 1px solid #ddd;">${date}</td>
                </tr>
            `;
        });
        
        html += `</tbody></table></div>`;
        
        // –ì—Ä–∞—Ñ–∏–∫ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º
        const testNames = ['–¢–µ—Å—Ç 1', '–¢–µ—Å—Ç 2', '–¢–µ—Å—Ç 3', '–¢–µ—Å—Ç 4', '–¢–µ—Å—Ç 5'];
        const testErrors = [aggregatedErrors.test1, aggregatedErrors.test2, aggregatedErrors.test3, aggregatedErrors.test4, aggregatedErrors.test5];
        const maxErrors = Math.max(...testErrors);
        
        html += `
            <div style="margin-top: 40px; padding: 25px; background: #f8f9fa; border-radius: 10px;">
                <h3 style="color: #E94A4E; margin-bottom: 20px;">üìâ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø–æ —Ç–µ—Å—Ç–∞–º</h3>
                <div style="display: flex; flex-direction: column; gap: 15px;">
        `;
        
        testNames.forEach((name, index) => {
            const errors = testErrors[index];
            const percentage = maxErrors > 0 ? (errors / maxErrors) * 100 : 0;
            const width = Math.max(10, percentage);
            
            html += `
                <div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span style="font-weight: 600;">${name}</span>
                        <span style="color: ${errors > 0 ? '#EA4335' : '#34A853'}; font-weight: bold;">${errors}</span>
                    </div>
                    <div style="height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden;">
                        <div style="height: 100%; width: ${width}%; background: linear-gradient(to right, #E94A4E, #FFB700); border-radius: 5px;"></div>
                    </div>
                </div>
            `;
        });
        
        html += `</div></div>`;
    }
    
    html += `
            </div>
        </div>
    `;
    
    document.body.insertAdjacentHTML('beforeend', html);
}

function closeErrorStatistics() {
    const modal = document.getElementById('error-statistics-modal');
    if (modal) modal.remove();
}
 </script>
</body>

</html>


